import{S as T,i as q,s as E,e as v,t as D,b as p,c as y,d as _,k as L,n as I,f as h,a as x,m as S,o as j,p as k,q as w,u as A,l as M,D as N,h as P,E as X,F as z,B as Y,z as F,A as G,C as Z,G as U,H as V}from"../vendor.b1a1e755.js";import{c as O}from"../config.e27a43c6.js";import{c as ee,d as te,e as ne,f as J,a as le,h as ie}from"../payment.b0fc3cb8.js";import{l as se}from"../logger.5235f1ff.js";function re(a){let e,n,s;return{c(){e=v("div"),n=v("a"),s=D(a[0]),p(n,"class","text-gray-600 text-base"),p(n,"href",a[1]),p(n,"target","_blank"),p(e,"class","px-12 h-12 flex items-center ")},m(i,t){y(i,e,t),_(e,n),_(n,s)},p(i,[t]){t&1&&L(s,i[0]),t&2&&p(n,"href",i[1])},i:I,o:I,d(i){i&&h(e)}}}function ae(a,e,n){let{title:s}=e,{link:i}=e;return a.$$set=t=>{"title"in t&&n(0,s=t.title),"link"in t&&n(1,i=t.link)},[s,i]}class B extends T{constructor(e){super();q(this,e,ae,re,E,{title:0,link:1})}}function oe(a){let e,n,s,i,t,l,r,o,f;return i=new B({props:{title:"\u5982\u4F55\u4F7F\u7528\u6FC0\u6D3B\u7801\uFF1F",link:O.key_usage_doc_url}}),l=new B({props:{title:"\u5E2E\u52A9\u6587\u6863",link:O.doc_url}}),o=new B({props:{title:"\u8BC4\u4EF7\u6269\u5C55",link:a[0]}}),{c(){e=v("div"),n=v("div"),n.innerHTML='<h2 class="text-lg">\u5173\u4E8E</h2>',s=x(),S(i.$$.fragment),t=x(),S(l.$$.fragment),r=x(),S(o.$$.fragment),p(n,"class","ext-title h-14 flex items-center pl-12 mb-4 svelte-v5bshl"),p(e,"class","max-w-2xl bg-white mx-auto rounded-lg pb-4 mt-5")},m(c,d){y(c,e,d),_(e,n),_(e,s),j(i,e,null),_(e,t),j(l,e,null),_(e,r),j(o,e,null),f=!0},p:I,i(c){f||(k(i.$$.fragment,c),k(l.$$.fragment,c),k(o.$$.fragment,c),f=!0)},o(c){w(i.$$.fragment,c),w(l.$$.fragment,c),w(o.$$.fragment,c),f=!1},d(c){c&&h(e),A(i),A(l),A(o)}}}function fe(a){return[ee()]}class ue extends T{constructor(e){super();q(this,e,fe,oe,E,{})}}function Q(a){let e,n=a[3].label+"",s,i,t,l;return{c(){e=v("button"),s=D(n),e.disabled=a[2],p(e,"class",i=""+(a[2]?" bg-gray-300 cursor-default":"action")+" text-white rounded px-4 py-1 text-sm svelte-rpw1w5")},m(r,o){y(r,e,o),_(e,s),t||(l=M(e,"click",a[7]),t=!0)},p(r,o){o&8&&n!==(n=r[3].label+"")&&L(s,n),o&4&&(e.disabled=r[2]),o&4&&i!==(i=""+(r[2]?" bg-gray-300 cursor-default":"action")+" text-white rounded px-4 py-1 text-sm svelte-rpw1w5")&&p(e,"class",i)},d(r){r&&h(e),t=!1,l()}}}function ce(a){let e,n,s,i,t,l,r,o,f,c,d,u=a[3]&&Q(a);return{c(){e=v("div"),n=v("span"),s=D(a[0]),i=D("\uFF1A"),t=x(),l=v("div"),r=v("input"),f=x(),u&&u.c(),p(n,"class","text-gray-600 text-base"),p(r,"type","text"),r.disabled=a[2],p(r,"class",o=""+((a[1]?" border-red-400":"border-transparent")+" mt-1 block w-full rounded-md bg-gray-100 focus:border-gray-500 focus:bg-white focus:ring-0")),p(l,"class","flex-grow mr-28 text-base text-gray-600"),p(e,"class","px-12 h-12 flex items-center")},m(b,m){y(b,e,m),_(e,n),_(n,s),_(n,i),_(e,t),_(e,l),_(l,r),N(r,a[4]),_(e,f),u&&u.m(e,null),c||(d=M(r,"input",a[6]),c=!0)},p(b,[m]){m&1&&L(s,b[0]),m&4&&(r.disabled=b[2]),m&2&&o!==(o=""+((b[1]?" border-red-400":"border-transparent")+" mt-1 block w-full rounded-md bg-gray-100 focus:border-gray-500 focus:bg-white focus:ring-0"))&&p(r,"class",o),m&16&&r.value!==b[4]&&N(r,b[4]),b[3]?u?u.p(b,m):(u=Q(b),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i:I,o:I,d(b){b&&h(e),u&&u.d(),c=!1,d()}}}function de(a,e,n){let{title:s}=e,{error:i}=e,{disabled:t}=e,{action:l=null}=e;const r=P();let o;function f(){o=this.value,n(4,o)}const c=()=>r("valide",o);return a.$$set=d=>{"title"in d&&n(0,s=d.title),"error"in d&&n(1,i=d.error),"disabled"in d&&n(2,t=d.disabled),"action"in d&&n(3,l=d.action)},[s,i,t,l,o,r,f,c]}class me extends T{constructor(e){super();q(this,e,de,ce,E,{title:0,error:1,disabled:2,action:3})}}function R(a){let e,n=a[2].label+"",s,i,t;return{c(){e=v("button"),s=D(n),p(e,"class","action text-white rounded px-4 py-1 text-sm svelte-rpw1w5")},m(l,r){y(l,e,r),_(e,s),i||(t=M(e,"click",a[4]),i=!0)},p(l,r){r&4&&n!==(n=l[2].label+"")&&L(s,n)},d(l){l&&h(e),i=!1,t()}}}function ge(a){let e,n,s,i,t,l,r,o,f=a[2]&&R(a);return{c(){e=v("div"),n=v("span"),s=D(a[0]),i=D("\uFF1A"),t=x(),l=v("span"),r=D(a[1]),o=x(),f&&f.c(),p(n,"class","text-gray-600 text-base"),p(l,"class","text-gray-800 text-lg flex-grow"),p(e,"class","px-12 h-12 flex items-center")},m(c,d){y(c,e,d),_(e,n),_(n,s),_(n,i),_(e,t),_(e,l),_(l,r),_(e,o),f&&f.m(e,null)},p(c,[d]){d&1&&L(s,c[0]),d&2&&L(r,c[1]),c[2]?f?f.p(c,d):(f=R(c),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i:I,o:I,d(c){c&&h(e),f&&f.d()}}}function _e(a,e,n){let{title:s}=e,{description:i}=e,{action:t=null}=e;const l=P(),r=()=>l("action");return a.$$set=o=>{"title"in o&&n(0,s=o.title),"description"in o&&n(1,i=o.description),"action"in o&&n(2,t=o.action)},[s,i,t,l,r]}class H extends T{constructor(e){super();q(this,e,_e,ge,E,{title:0,description:1,action:2})}}function pe(a){let e,n,s,i;return e=new H({props:{title:"\u5230\u671F\u65F6\u95F4",description:"--"}}),s=new me({props:{title:"\u6FC0\u6D3B\u7801",action:{label:"\u9A8C\u8BC1"},error:a[1]==="error",disabled:a[3]}}),s.$on("valide",a[4]),{c(){S(e.$$.fragment),n=x(),S(s.$$.fragment)},m(t,l){j(e,t,l),y(t,n,l),j(s,t,l),i=!0},p(t,l){const r={};l&2&&(r.error=t[1]==="error"),l&8&&(r.disabled=t[3]),s.$set(r)},i(t){i||(k(e.$$.fragment,t),k(s.$$.fragment,t),i=!0)},o(t){w(e.$$.fragment,t),w(s.$$.fragment,t),i=!1},d(t){A(e,t),t&&h(n),A(s,t)}}}function be(a){let e,n,s,i;return e=new H({props:{title:"\u5230\u671F\u65F6\u95F4",description:J(a[0].expire_at),action:{label:"\u7EED\u8D39"}}}),e.$on("action",le),s=new H({props:{title:"\u6FC0\u6D3B\u7801",description:a[0].key}}),{c(){S(e.$$.fragment),n=x(),S(s.$$.fragment)},m(t,l){j(e,t,l),y(t,n,l),j(s,t,l),i=!0},p(t,l){const r={};l&1&&(r.description=J(t[0].expire_at)),e.$set(r);const o={};l&1&&(o.description=t[0].key),s.$set(o)},i(t){i||(k(e.$$.fragment,t),k(s.$$.fragment,t),i=!0)},o(t){w(e.$$.fragment,t),w(s.$$.fragment,t),i=!1},d(t){A(e,t),t&&h(n),A(s,t)}}}function W(a){let e,n,s,i,t;return{c(){e=v("div"),n=D(a[2]),p(e,"class",s=""+(a[1]==="error"?"bg-red-100 text-red-500":"bg-green-100 text-green-500")+" max-w-2xl mx-auto pl-12 rounded py-1 mt-px")},m(l,r){y(l,e,r),_(e,n),t=!0},p(l,r){a=l,(!t||r&4)&&L(n,a[2]),(!t||r&2&&s!==(s=""+(a[1]==="error"?"bg-red-100 text-red-500":"bg-green-100 text-green-500")+" max-w-2xl mx-auto pl-12 rounded py-1 mt-px"))&&p(e,"class",s)},i(l){t||(X(()=>{i||(i=z(e,V,{delay:250,duration:300,easing:U},!0)),i.run(1)}),t=!0)},o(l){i||(i=z(e,V,{delay:250,duration:300,easing:U},!1)),i.run(0),t=!1},d(l){l&&h(e),l&&i&&i.end()}}}function ve(a){let e,n,s,i,t,l,r,o,f,c;i=new H({props:{title:"\u5F53\u524D\u7248\u672C",description:a[0].validated?"\u9AD8\u7EA7\u7248":"\u57FA\u7840\u7248"}});const d=[be,pe],u=[];function b(g,$){return g[0].validated?0:1}l=b(a),r=u[l]=d[l](a);let m=a[1]!=="none"&&W(a);return{c(){e=v("div"),n=v("div"),n.innerHTML='<h2 class="text-lg">\u6FC0\u6D3B\u7801</h2>',s=x(),S(i.$$.fragment),t=x(),r.c(),o=x(),m&&m.c(),f=Y(),p(n,"class","ext-title h-14 flex items-center pl-12 mb-4 svelte-v5bshl"),p(e,"class","max-w-2xl bg-white mx-auto rounded-lg pb-4 mt-5")},m(g,$){y(g,e,$),_(e,n),_(e,s),j(i,e,null),_(e,t),u[l].m(e,null),y(g,o,$),m&&m.m(g,$),y(g,f,$),c=!0},p(g,[$]){const C={};$&1&&(C.description=g[0].validated?"\u9AD8\u7EA7\u7248":"\u57FA\u7840\u7248"),i.$set(C);let K=l;l=b(g),l===K?u[l].p(g,$):(F(),w(u[K],1,1,()=>{u[K]=null}),G(),r=u[l],r?r.p(g,$):(r=u[l]=d[l](g),r.c()),k(r,1),r.m(e,null)),g[1]!=="none"?m?(m.p(g,$),$&2&&k(m,1)):(m=W(g),m.c(),k(m,1),m.m(f.parentNode,f)):m&&(F(),w(m,1,1,()=>{m=null}),G())},i(g){c||(k(i.$$.fragment,g),k(r),k(m),c=!0)},o(g){w(i.$$.fragment,g),w(r),w(m),c=!1},d(g){g&&h(e),A(i),u[l].d(),g&&h(o),m&&m.d(g),g&&h(f)}}}function ke(a,e,n){let s={key:"",urlkey:"",validated:!1,expire_at:0},i="none",t="",l=0,r=!1;const o=d=>{const u=ie(d);n(0,s.validated=u.valid,s),n(0,s.expire_at=u.expire_at,s),n(0,s.key=d.orderid,s),n(0,s.urlkey=d.urlkey,s)};Z(()=>{(async()=>{const u=await te("detail");u&&o(u)})()});const f=(d,u="error")=>{n(1,i=u),n(2,t=d),clearTimeout(l),l=+setTimeout(()=>{n(1,i="none")},3e3)};return[s,i,t,r,async d=>{const u=d.detail;if(!u||u.trim().length===0){f("\u6FC0\u6D3B\u7801\u65E0\u6548","error");return}try{n(3,r=!0);const m=await(await fetch(`${O.server_host}/license?key=${u.trim()}`)).json();if(n(3,r=!1),m.code===0){const g=m.data;o(g),await ne({detail:g,savedAt:Date.now()}),f("\u9A8C\u8BC1\u6210\u529F","success")}else f(m.message,"error")}catch(b){se.e(b),n(3,r=!1),f(b.message||"\u9A8C\u8BC1\u51FA\u9519","error")}}]}class we extends T{constructor(e){super();q(this,e,ke,ve,E,{})}}function ye(a){let e,n,s,i,t;return n=new we({}),i=new ue({}),{c(){e=v("main"),S(n.$$.fragment),s=x(),S(i.$$.fragment),p(e,"class","")},m(l,r){y(l,e,r),j(n,e,null),_(e,s),j(i,e,null),t=!0},p:I,i(l){t||(k(n.$$.fragment,l),k(i.$$.fragment,l),t=!0)},o(l){w(n.$$.fragment,l),w(i.$$.fragment,l),t=!1},d(l){l&&h(e),A(n),A(i)}}}class he extends T{constructor(e){super();q(this,e,null,ye,E,{})}}new he({target:document.getElementById("app")});
